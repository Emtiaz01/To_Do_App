<section class="todo-container">
  <div class="todo-header">
    
    <form [formGroup]="taskForm" (ngSubmit)="onSave()" class="todo-form">
      <div class="input-group">
        <input
          type="text"
          placeholder="Task Name *"
          formControlName="taskName"
          class="todo-input"
          [class.invalid]="taskForm.get('taskName')?.invalid && taskForm.get('taskName')?.touched"
        />
        <span class="error-msg" *ngIf="taskForm.get('taskName')?.invalid && taskForm.get('taskName')?.touched">
          Required
        </span>
      </div>

      <div class="input-group">
        <input
          type="text"
          placeholder="Task Description"
          formControlName="taskDescription"
          class="todo-input"
        />
      </div>

      <div class="input-group">
        <input
          type="date"
          formControlName="taskDate"
          class="todo-input"
          [class.invalid]="taskForm.get('taskDate')?.invalid && taskForm.get('taskDate')?.touched"
        />
        <span class="error-msg" *ngIf="taskForm.get('taskDate')?.invalid && taskForm.get('taskDate')?.touched">
          Required
        </span>
      </div>

      <div class="input-group">
        <input
          type="time"
          formControlName="taskTime"
          class="todo-input"
          [class.invalid]="taskForm.get('taskTime')?.invalid && taskForm.get('taskTime')?.touched"
        />
        <span class="error-msg" *ngIf="taskForm.get('taskTime')?.invalid && taskForm.get('taskTime')?.touched">
          Required
        </span>
      </div>

   <div class="button">
  <button type="submit" class="todo-btn">
    Add
  </button>
</div>

    </form>
  </div>

  <div class="todo-card">
    <table class="todo-table">
      <thead>
        <tr>
          <th>SL</th>
          <th>Status</th>
          <th>Task</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of TaskList; let i = index">
          <td>{{ i + 1 }}</td>
          <td>
            <input
              type="checkbox"
              [checked]="item.iscompleted"
              (change)="onCheck(i)"
            />
          </td>

          <td [class.completed]="item.iscompleted">
            <ng-container *ngIf="editingTaskId === item.id; else viewMode">
              <input
                type="text"
                [formControl]="editControl"
                class="todo-input"
              />
            </ng-container>

            <ng-template #viewMode>
              {{ item.taskName }}
            </ng-template>
          </td>

          <td>
            <ng-container *ngIf="editingTaskId === item.id; else actionButtons">
              <button (click)="saveEdit(item.id!)">Save</button>
              <button (click)="editingTaskId = null">Cancel</button>
            </ng-container>

            <ng-template #actionButtons>
              <button (click)="editTask(i)">Edit</button>
              <button (click)="deleteTask(i)">Delete</button>
              <button (click)="viewDetails(item.id)">View Details</button>
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="button-container" *ngIf="TaskList && TaskList.length > 0">
  <button (click)="toggleSelectAll()" class="todo-btn">
    {{ selectAllState ? 'Deselect All' : 'Select All' }}
  </button>
</div>
</section>
